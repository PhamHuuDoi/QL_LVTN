extends ../../layouts/default.pug

block main
  .container-fluid.mt-3
    .d-flex.justify-content-between.align-items-center.mb-3
      h4.mb-0 Danh sách đánh giá giữa kỳ
    
    if danhgias.length
      .card
        .card-body.p-0
          .table-responsive
            table.table.table-bordered.table-sm.table-hover.mb-0(style="font-size: 0.9rem;")
              thead.table-dark
                tr
                  th.text-center(style="width: 100px") MSSV
                  th(style="min-width: 150px") Họ tên
                  th.text-center(style="width: 100px") Lớp
                  th.text-center(style="width: 80px") Nhóm
                  th(style="min-width: 200px") Đề tài
                  th(style="min-width: 150px") Giảng viên đánh giá
                  th.text-center(style="width: 100px") Điểm GK
                  th.text-center(style="width: 120px") Kết quả
                  th.text-center(style="width: 80px") Xem
              tbody
                each dg in danhgias
                  tr
                    td.text-center= dg.sv_id ? dg.sv_id.msvv : "—"
                    td= dg.sv_id ? dg.sv_id.ten : "—"
                    td.text-center= dg.sv_id ? dg.sv_id.lop : "—"
                    td.text-center
                      if dg.sv_id && dg.sv_id.group
                        strong= dg.sv_id.group
                    td
                      if dg.detai_id
                        = dg.detai_id.ten
                      else
                        span.text-muted Chưa có đề tài
                    td= dg.giangvien_id ? dg.giangvien_id.hoten : "—"
                    td.text-center
                      if dg.diem != null
                        span.badge.bg-primary.badge-sm= `${dg.diem}%`
                      else 
                        span.badge.bg-secondary.badge-sm Chưa đánh giá
                    td.text-center
                      if dg.ketqua
                        if dg.ketqua.toLowerCase().includes('đạt')
                          span.badge.bg-success.badge-sm= dg.ketqua
                        else if dg.ketqua.toLowerCase().includes('không')
                          span.badge.bg-danger.badge-sm= dg.ketqua
                        else
                          span.badge.bg-warning.badge-sm= dg.ketqua
                      else
                        span.badge.bg-secondary.badge-sm Chưa có
                    td.text-center
                      a.btn.btn-outline-info.btn-sm(href=`/admin/danhgiagk/detail/${dg._id}` style="padding: 0.2rem 0.5rem; font-size: 0.8rem;") Xem
    else
      .text-center.py-4
        p.text-muted.mb-0 Không có đánh giá nào

  style.
    .table-responsive {
      overflow-x: auto;
      border-radius: 4px;
    }
    .table {
      width: 100%;
      margin-bottom: 0;
    }
    .table-sm th, .table-sm td {
      padding: 0.5rem 0.5rem;
      vertical-align: middle;
    }
    .table-dark th {
      background-color: #343a40;
      border-color: #454d55;
    }
    .badge-sm {
      font-size: 0.75rem;
      padding: 0.2rem 0.4rem;
    }
    .card {
      border: 1px solid #dee2e6;
      border-radius: 0.375rem;
    }
    .btn-sm {
      min-width: 60px;
    }
    .text-muted {
      color: #6c757d !important;
    }