extends ../../layouts/default.pug

block main
  .container-fluid
    .d-flex.justify-content-between.align-items-center.mb-3
      h3.mb-0 Danh s√°ch sinh vi√™n ƒë∆∞·ª£c ph√¢n c√¥ng

    // üîç Form t√¨m ki·∫øm + l·ªçc nh√≥m (CH·ªà G·ª¨I QUERY, KO X·ª¨ L√ù)
    form.form-inline.mb-3(method="GET", action="")
      input.form-control.mr-2(
        type="text"
        name="keyword"
        placeholder="T√¨m theo t√™n ho·∫∑c MSSV"
        value=keyword
      )
      select.form-control.mr-2(name="filterGroup")
        option(value="") -- L·ªçc theo nh√≥m --
        option(value="none" selected=(filterGroup=="none")) Ch∆∞a c√≥ nh√≥m
        option(value="single" selected=(filterGroup=="single")) Nh√≥m 1 sinh vi√™n
        option(value="full" selected=(filterGroup=="full")) Nh√≥m ƒë·ªß 2 sinh vi√™n
      button.btn.btn-outline-success(type="submit") L·ªçc

    if sinhviens.length
      table.table.table-striped.table-bordered.table-hover
        thead.table-dark
          tr
            th #
            th M√£ SV
            th H·ªç t√™n
            th L·ªõp
            th Ng√†nh
            th Email
            th Nh√≥m
            th(width="160") Thay ƒë·ªïi nh√≥m
        tbody
          each sv, index in sinhviens
            tr
              td #{index + 1}
              td #{sv.msvv}
              td #{sv.ten}
              td #{sv.lop}
              td #{sv.nganh}
              td #{sv.email}
              td #{sv.group || 'Ch∆∞a c√≥'}

              td
                form(method="POST", action=`/giangvien/sinhvien/update-group/${sv._id}`)
                  .input-group
                    input.form-control(
                      type="number"
                      min="1"
                      max="99"
                      name="group"
                      value=sv.group
                      placeholder="Nh·∫≠p nh√≥m"
                    )
                    .input-group-append
                      button.btn.btn-primary(type="submit") L∆∞u

    else
      p.text-muted.text-center.mt-4 Kh√¥ng c√≥ sinh vi√™n n√†o.

  // SweetAlert th√¥ng b√°o
  if success
    script.
      Swal.fire('Th√†nh c√¥ng', '#{success}', 'success');

  if error
    script.
      Swal.fire('L·ªói', '#{error}', 'error');
